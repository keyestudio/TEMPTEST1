

# 第10课 画地为牢智能车 

## （1）项目介绍：

前面我们详细的介绍了智能车上各个传感器、模块、扩展板的使用方法。在这里我们可以结合前面课程中知识制作一个画地为牢智能车。实验中，我们通过循迹传感器检测智能车底部是否存在黑线，然后根据检测结果控制两个电机的转动，从而把智能车关在黑线圈中即画地为牢。

## （2）流程图：

画地为牢智能车具体逻辑如下表格。


|检测|中循迹传感器|检测到黑线：高电平|
|-|-|-|
|检测|中循迹传感器|检测到白线：低电平|
|检测|左循迹传感器|检测到黑线：高电平|
|检测|左循迹传感器|检测到白线：低电平|
|检测|右循迹传感器|检测到黑线：高电平|
|检测|右循迹传感器|检测到白线：低电平|
|条件|状态|
|左循迹传感器没检测到黑线且中循迹传感器没检测到黑线且右循迹传感器没检测到黑线|前进（PWM设为200）|
|左循迹传感器检测到黑线或者中循迹传感器检测到黑线 或者右循迹传感器检测到黑线|后退（PWM设为200） 然后左旋转（PWM设为200）|




按照前面思路设计好智能车后，我们就需要按照设计思路开始制作智能车。我们需要设计对应的接线，测试代码，然后接线上传代码，运行，确保智能车能够实现理想中的功能。

## （3）接线图：循迹模块+电机

![](../../media/0e29db0631c1867b11dfbc4b9c1c6e37.png)

## （4）测试代码：

在事件栏拖出Arduino启动

![](../../media/b638318eafab837df9c41ade16cbacbb.png)

在变量类型栏拖出设置变量模块，分别设置L_val、M_val、R_val三个变量

![](../../media/195f18331177afd2ea7f6b7abc8dece8.png)

在控制栏拖出重复执行模块

![](../../media/82327e6d0560067bda416fc3b1965829.png)

设置三个变量L_val、M_val、R_val分别赋值11、7、8脚读取的值

![](../../media/92f61254359ed9500361824d1e251e5a.png)

设置条件L_val == 0或 M_val == 0 或 R_val == 0时执行前进代码

![](../../media/98bfd4efc535e4777e76342e13e08c23.png)

否则执行后退代码500ms；在执行左转代码800ms

![](../../media/b609b6eff0d0aa97d9b407f4f4db0b80.png)

（在上传程序代码前，需要把蓝牙模块取下，否则代码会上传失败。）

完整代码：

![](../../media/67a46f4cefe726b593e905c7b395a553.png)

## （5）测试结果：

当小车行驶过程中检测到黑线立即后退500毫秒，然后左转800毫秒继续行驶。

